<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dashboard | BlueCrumbs Admin</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/logo.png">
    <meta name="theme-color" content="#0d2c54">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="css/admin-style.css">
    <style>
        /* Global box-sizing fix */
        * {
            box-sizing: border-box;
        }

        /* Responsive improvements */
        @media (max-width: 768px) {
            .stats-row {
                grid-template-columns: 1fr !important;
            }

            .date-filters {
                flex-direction: column !important;
                align-items: stretch !important;
            }

            .date-filters input,
            .date-filters button {
                width: 100% !important;
                min-width: auto !important;
            }

            .form-group {
                grid-column: 1 / -1 !important;
            }

            table {
                font-size: 0.9rem;
            }

            th, td {
                padding: 10px !important;
            }
        }

        @media (max-width: 480px) {
            .content-card {
                padding: 15px !important;
            }

            .stats-row .stat-card {
                padding: 15px !important;
            }

            .stats-row h3 {
                font-size: 1.5rem !important;
            }

            form {
                padding: 20px !important;
            }
        }

        /* Prevent input overflow */
        input, select, textarea {
            max-width: 100%;
        }

        /* Fix table responsiveness */
        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table {
            min-width: 600px;
        }
    </style>
</head>
<body>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="/images/logo.png" alt="BlueCrumbs Logo" class="sidebar-logo" style="max-height: 40px; width: auto;">
                <span class="sidebar-logo-text">Admin Panel</span>
            </div>
            <ul class="sidebar-menu">
                <li class="menu-item active" data-tab="inquiries"><a href="#inquiries"><i class="fas fa-envelope-open-text"></i><span>Inquiries</span></a></li>
                <li class="menu-item" data-tab="newsletter"><a href="#newsletter"><i class="fas fa-envelope"></i><span>Newsletter Subscribers</span></a></li>
                <li class="menu-item" data-tab="builder"><a href="#builder"><i class="fas fa-building"></i><span>Builder Inquiries</span></a></li>
                <li class="menu-item" data-tab="location"><a href="#location"><i class="fas fa-map-marker-alt"></i><span>Location Inquiries</span></a></li>
                <li class="menu-item" data-tab="career"><a href="#career"><i class="fas fa-briefcase"></i><span>Career Submissions</span></a></li>
                <li class="menu-item" data-tab="projects"><a href="#projects"><i class="fas fa-home"></i><span>Add Property</span></a></li>
            </ul>
        </aside>

        <div class="main-content">
            <header class="topbar">
                <button class="mobile-menu-toggle" aria-label="Toggle menu">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="topbar-title"><h2>Inquiries Dashboard</h2><p>View and manage recent property inquiries.</p></div>
                <div class="topbar-user"><button id="logout-button" class="btn-logout"><i class="fas fa-sign-out-alt"></i><span class="logout-text">Logout</span></button></div>
                <div class="mobile-nav-overlay"></div>
                <nav class="mobile-nav">
                    <button class="mobile-close-btn"><i class="fas fa-times"></i></button>
                    <ul class="mobile-nav-list">
                        <li class="mobile-nav-header">Navigation</li>
                        <li><a href="#inquiries" class="mobile-nav-item" data-tab="inquiries"><i class="fas fa-envelope-open-text"></i> Inquiries</a></li>
                        <li><a href="#newsletter" class="mobile-nav-item" data-tab="newsletter"><i class="fas fa-envelope"></i> Newsletter Subscribers</a></li>
                        <li><a href="#builder" class="mobile-nav-item" data-tab="builder"><i class="fas fa-building"></i> Builder Inquiries</a></li>
                        <li><a href="#location" class="mobile-nav-item" data-tab="location"><i class="fas fa-map-marker-alt"></i> Location Inquiries</a></li>
                        <li><a href="#career" class="mobile-nav-item" data-tab="career"><i class="fas fa-briefcase"></i> Career Submissions</a></li>
                        <li><a href="#projects" class="mobile-nav-item" data-tab="projects"><i class="fas fa-home"></i> Add Property</a></li>
                    </ul>
                </nav>
            </header>

            <main class="content-area">
                <!-- Inquiries Tab -->
                <div class="content-card tab-content" id="inquiries-tab" style="display: block;">
                    <div class="stats-row" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px;">
                            <h3 style="margin: 0; font-size: 2rem;" id="total-inquiries">0</h3>
                            <p style="margin: 5px 0 0 0; opacity: 0.9;">Total Inquiries</p>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 10px;">
                            <h3 style="margin: 0; font-size: 2rem;" id="today-inquiries">0</h3>
                            <p style="margin: 5px 0 0 0; opacity: 0.9;">Today's Inquiries</p>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 10px;">
                            <h3 style="margin: 0; font-size: 2rem;" id="week-inquiries">0</h3>
                            <p style="margin: 5px 0 0 0; opacity: 0.9;">This Week</p>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 10px;">
                            <h3 style="margin: 0; font-size: 2rem;" id="month-inquiries">0</h3>
                            <p style="margin: 5px 0 0 0; opacity: 0.9;">This Month</p>
                        </div>
                    </div>
                    
                    <div class="filter-section" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <div class="search-bar" style="margin-bottom: 15px; position: relative;">
                            <i class="fas fa-search" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #999;"></i>
                            <input type="text" id="search-input" placeholder="Search by name, email, or phone..." style="width: 100%; padding: 12px 15px 12px 40px; border-radius: 8px; border: 2px solid #e0e0e0; box-sizing: border-box;">
                        </div>
                        <div class="date-filters" style="display: flex; flex-wrap: wrap; gap: 10px; align-items: center;">
                            <input type="date" id="start-date" title="Start Date" style="flex: 1; min-width: 140px; padding: 10px; border-radius: 8px; border: 2px solid #e0e0e0; box-sizing: border-box;">
                            <span style="color: #666;">to</span>
                            <input type="date" id="end-date" title="End Date" style="flex: 1; min-width: 140px; padding: 10px; border-radius: 8px; border: 2px solid #e0e0e0; box-sizing: border-box;">
                            <button id="filter-button" class="btn-filter" style="background: #667eea; color: white; padding: 10px 20px; border-radius: 8px; border: none; cursor: pointer; white-space: nowrap;">Filter</button>
                            <button id="clear-filter-button" class="btn-clear-filter" title="Clear Filters" style="background: #dc3545; color: white; padding: 10px 15px; border-radius: 8px; border: none; cursor: pointer;"><i class="fas fa-times"></i></button>
                        </div>
                    </div>

                    <div class="table-container" style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="overflow-x: auto;"> 
                            <table style="width: 100%; border-collapse: separate; border-spacing: 0;">
                                <thead>
                                    <tr style="background: #f8f9fa;">
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Name</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Email</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Phone</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Source</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Message</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Date</th>
                                        <th style="padding: 15px; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="inquiries-table-body"></tbody>
                            </table>
                        </div>
                        <div id="loading-spinner" class="spinner-container"><div class="spinner"></div></div>
                    </div>
                </div>
                
                <!-- Newsletter Subscribers Tab -->
                <div class="content-card tab-content" id="newsletter-tab" style="display: none;">
                    <h3 style="margin-bottom: 20px;">Newsletter Subscribers</h3>
                    <button id="copy-all-emails" class="btn-primary" style="margin-bottom: 20px;">
                        <i class="fas fa-copy"></i> Copy All Emails
                    </button>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Email</th>
                                    <th>Subscribed Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="newsletter-table-body"></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Builder Inquiries Tab -->
                <div class="content-card tab-content" id="builder-tab" style="display: none;">
                    <h3 style="margin-bottom: 20px;">Builder Inquiries</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Builder Name</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Message</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="builder-table-body"></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Location Inquiries Tab -->
                <div class="content-card tab-content" id="location-tab" style="display: none;">
                    <h3 style="margin-bottom: 20px;">Location Inquiries</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Location</th>
                                    <th>Property Type</th>
                                    <th>Budget</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="location-table-body">
                                <tr><td colspan="9">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Career Submissions Tab -->
                <div class="content-card tab-content" id="career-tab" style="display: none;">
                    <h3 style="margin-bottom: 20px;">Career Submissions</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Position</th>
                                    <th>Experience</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="career-table-body"></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Add Property Tab -->
                <div class="content-card tab-content" id="projects-tab" style="display: none;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                        <h2 style="margin: 0; font-size: 2rem;"><i class="fas fa-building"></i> Add New Property</h2>
                        <p style="margin: 10px 0 0 0; opacity: 0.9;">Fill in the details below to add a new property to the database</p>
                    </div>
                    
                    <form id="add-property-form" style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); box-sizing: border-box;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-home" style="color: #667eea; margin-right: 5px;"></i> Project Name *
                                </label>
                                <input type="text" name="project_name" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; transition: all 0.3s; box-sizing: border-box;"
                                    placeholder="Enter project name">
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-hard-hat" style="color: #f093fb; margin-right: 5px;"></i> Builder Name *
                                </label>
                                <input type="text" name="builder_name" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; box-sizing: border-box;"
                                    placeholder="Enter builder name">
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-city" style="color: #4facfe; margin-right: 5px;"></i> Project Type *
                                </label>
                                <select name="project_type" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; background: white; box-sizing: border-box;">
                                    <option value="">Select Type</option>
                                    <option value="Residential">🏠 Residential</option>
                                    <option value="Commercial">🏢 Commercial</option>
                                    <option value="Industrial">🏭 Industrial</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-rupee-sign" style="color: #43e97b; margin-right: 5px;"></i> Min Price *
                                </label>
                                <input type="text" name="min_price" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; box-sizing: border-box;"
                                    placeholder="e.g., 65 Lac or 1.2 Cr">
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-rupee-sign" style="color: #43e97b; margin-right: 5px;"></i> Max Price *
                                </label>
                                <input type="text" name="max_price" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; box-sizing: border-box;"
                                    placeholder="e.g., 1.5 Cr or 2.5 Cr">
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-expand" style="color: #fa709a; margin-right: 5px;"></i> Size (sq.ft) *
                                </label>
                                <input type="text" name="size_sqft" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; box-sizing: border-box;"
                                    placeholder="e.g., 1200-1800">
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-bed" style="color: #feca57; margin-right: 5px;"></i> BHK Configuration *
                                </label>
                                <input type="text" name="bhk" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; box-sizing: border-box;"
                                    placeholder="e.g., 2,3,4 BHK">
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-clock" style="color: #ff6b6b; margin-right: 5px;"></i> Status/Possession *
                                </label>
                                <select name="status_possession" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; background: white; box-sizing: border-box;">
                                    <option value="">Select Status</option>
                                    <option value="Ready">✅ Ready to Move</option>
                                    <option value="Under Construction">🚧 Under Construction</option>
                                    <option value="New Launch">🆕 New Launch</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label style="display: block; margin-bottom: 8px; color: #495057; font-weight: 600;">
                                    <i class="fas fa-map-marker-alt" style="color: #ee5a6f; margin-right: 5px;"></i> Location *
                                </label>
                                <input type="text" name="location" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; box-sizing: border-box;"
                                    placeholder="e.g., Sector 150 Noida">
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px; text-align: center;">
                            <button type="submit" class="btn-primary" 
                                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 40px; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);">
                                <i class="fas fa-plus-circle"></i> Add Property to Database
                            </button>
                        </div>
                    </form>
                    
                    <div id="property-status" style="margin-top: 20px;"></div>
                    
                    <!-- Recent Properties List -->
                    <div style="margin-top: 40px; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
                        <h3 style="color: #495057; margin-bottom: 20px;"><i class="fas fa-list"></i> Recently Added Properties</h3>
                        <div id="recent-properties-list" style="color: #6c757d;">No properties added yet in this session.</div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <div id="edit-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <form id="edit-form">
                <h2>Edit Inquiry</h2>
                <input type="hidden" id="edit-inquiry-id">
                <div class="input-group"><label for="edit-name">Name</label><input type="text" id="edit-name" required></div>
                <div class="input-group"><label for="edit-email">Email</label><input type="email" id="edit-email" required></div>
                <div class="input-group"><label for="edit-phone">Phone</label><input type="tel" id="edit-phone" required></div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary cancel-modal-button">Cancel</button>
                    <button type="submit" class="btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <div id="delete-confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content modal-sm">
            <h2 class="modal-title"><i class="fas fa-exclamation-triangle"></i> Confirm Deletion</h2>
            <p class="modal-text">Are you sure you want to permanently delete this inquiry?</p>
            <div class="modal-actions">
                <button type="button" class="btn-secondary cancel-modal-button">Cancel</button>
                <button type="button" id="confirm-delete-button" class="btn-danger">Delete</button>
            </div>
        </div>
    </div>

    <div id="toaster" class=""></div>
    <script src="js/api.js"></script>
    <script src="js/mobile-nav.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html>